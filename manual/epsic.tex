\documentclass[12pt]{article}

\usepackage{fullpage}
\usepackage{amssymb}

% bold math italic font
\newcommand{\mbf}[1]{\mbox{\boldmath $#1$}}
% bold math italic super- or subscript size font
\newcommand{\mbfs}[1]{\mbox{\scriptsize\boldmath $#1$}}

% equations
\newcommand{\Eqn}[1]{Equation~(\ref{eqn:#1})}
\newcommand{\Eqns}[3]{Equations~(\ref{eqn:#1}) #2~(\ref{eqn:#3})}
\newcommand{\eqn}[1]{equation~(\ref{eqn:#1})}
\newcommand{\eqns}[3]{equations~(\ref{eqn:#1}) #2~(\ref{eqn:#3})}

% sections
\newcommand{\Sec}[1]{Section~\ref{sec:#1}}
\newcommand{\Secs}[3]{Sections~\ref{sec:#1} #2~\ref{sec:#3}} 

% figures
\newcommand{\Fig}[1]{Figure~\ref{fig:#1}}
\newcommand{\Figs}[3]{Figures~\ref{fig:#1} #2~\ref{fig:#3}}

% tables
\newcommand{\Tab}[1]{Table~\ref{tab:#1}}
\newcommand{\Tabs}[3]{Tables~\ref{tab:#1} #2~\ref{tab:#3}}

% appendices
\newcommand{\App}[1]{Appendix~\ref{app:#1}}
\newcommand{\Apps}[1]{Appendices~\ref{app:#1}}

% symbol used for sqrt(-1)
\newcommand{\Ci}{\ensuremath{i}}

\newcommand{\C}{{\mathbb{C}}}
\newcommand{\R}{{\mathbb{R}}}

\newcommand{\rankfour}{\ensuremath{\mathbb{C}^2_{2;2}}}
\newcommand{\ranktwo}{\ensuremath{\mathbb{C}^4_{1;1}}}

\newcommand{\irow}{\mu} \newcommand{\icol}{\nu}
\newcommand{\srow}{j} \newcommand{\scol}{k}

\newcommand{\trace}{{\rm Tr}}
\newcommand{\real}{{\rm Re}}
\newcommand{\imag}{{\rm Im}}

\newcommand{\Rotation}{{\bf R}}
\newcommand{\Boost}{{\bf B}}

\newcommand{\vRotation}[1][n]{\ensuremath{\Rotation_{\mbfs{\hat #1}}}}
\newcommand{\vBoost}[1][m]{\ensuremath{\Boost_{\mbfs{\hat #1}}}}

\newcommand{\tr}[1]{\trace\ensuremath{ \left[ {#1} \right] }}
\newcommand{\re}[1]{\real\ensuremath{ \left[ {#1} \right] }}
\newcommand{\im}[1]{\imag\ensuremath{ \left[ {#1} \right] }}

\newcommand{\mean}[1]{\ensuremath{ \langle #1 \rangle }}
\newcommand{\expectation}[1]{\ensuremath{ E\left[ {#1} \right] }}
\newcommand{\smean}[1][ ]{\ensuremath{ \bar{#1} }}

\newcommand{\Linner}[2]{\ensuremath{ { {#1} \cdot {#2} } } }

\newcommand{\bilinear}[2]{\ensuremath{\left({#1},{#2}\right)}}

\newcommand{\outerBilinear}[2]{\ensuremath{{#1}\otimes{#2}}}
\newcommand{\stimes}{\ensuremath{\tilde{\otimes}}}
\newcommand{\spinorBilinear}[2]{\ensuremath{{#1}\,\stimes\,{#2}}}

% Define a bilinear operator \Delta(A,B)=(A-B)\otimes(A-B)
% \newcommand{\outerDiff}[2]{\ensuremath{{\mbf\Delta}({#1},{#2})}}

% Or, use the second tensor power
\newcommand{\outerDiff}[2]{\ensuremath{({#1}-{#2})^{\otimes 2}}}
\newcommand{\outerSymm}[2]{\ensuremath{{#1}\,\tilde{\odot}\,{#2}}}

\newcommand{\outerMueller}[2]{\ensuremath{{\bf M}_\otimes\bilinear{#1}{#2}}}
\newcommand{\spinorMueller}[2]{\ensuremath{{\bf M}_{\stimes}\bilinear{#1}{#2}}}

\newcommand{\exterior}[2]{\ensuremath{{#1}\wedge{#2}}}
\newcommand{\dc}[2]{\ensuremath{{#1}\,\mbf{:}\,{#2}}}

\newcommand{\rotat}{\ensuremath{\vRotation(\phi)}}
\newcommand{\boost}{\ensuremath{\vBoost(\beta)}}

\newcommand{\pauli}[1]{\ensuremath{\mbf{\sigma}_{#1}}}

\newcommand{\inv}[1]{\ensuremath{ {#1}^2 }}
\newcommand{\norm}[1]{\ensuremath{ \|{#1}\| }}

\newcommand{\element}[3]{\ensuremath{ \left\{ {#1} \right\}_{#2}^{#3} }}
\newcommand{\Celement}[1]{\element{#1}{\irow}{\icol}}

\newcommand{\instI}{\ensuremath{\xi}}

\begin{document}

\title{ {\sc epsic}: Electromagnetic Polarization Simulation in C++ }

\author{Willem van Straten}

\maketitle

\begin{abstract}

{\sc epsic} was written to verify the equations presented in
van Straten \& Tiburzi 2017, {\it The Statistics of Radio Astronomical Polarimetry: Disjoint, Superposed, and Composite Samples}, The Astrophysical Journal, 835:293.\footnote{http://dx.doi.org/10.3847/1538-4357/835/2/293}
It can be used to simulate the effects of integration over finite samples when more than one source is present. The sources can be disjoint (mutually exclusive), such that only one source emits at a given instant, or superposed, such that the electric fields are summed. It is also possible to simulate integration over a composite sample of unresolved disjoint modes.

\end{abstract}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section {Introduction}

{\sc epsic} performs the following Monte Carlo simulation.

\begin{enumerate}
\item Generate a sequence of $M$ random electric field vector
  instances $\mbf{e}$, each with statistically independent and
  identically distributed (iid) circular complex normal components;
  such a sequence is described by the population mean Stokes
  parameters [1,0,0,0].
  
\item To yield the desired population mean Stokes parameters, $S_\irow$,
  transform each electric field vector instance by the Hermitian square
  root of $2\mbf\rho=S_\irow\,\pauli{\irow}$.

\item Optionally perform amplitude modulation by multiplying each
  instance of $\mbf{e}$ by an iid random variate $u$ that is drawn
  from a log-normal distribution.  The log-normally distributed
  variate is generated from a normally distributed iid variate with
  zero mean and standard deviation $\varsigma$ and is normalized by
  the mean of the distribution, $\langle u \rangle =
  \exp(\varsigma^2/2)$, such that the mean of the amplitude modulating
  function is unity.
  \begin{itemize}
  \item
  To simulate rectangular subpulses defined by the sub-sample size $n$, a
  single value of $u$ is applied to $n$ consecutive instances of
  $\mbf{e}$.
  \item
  The modulation function can also be smoothed using a box-car of specified
  width.
  \end{itemize}
  
\item If simulating \emph{superposed samples}, repeat all of the previous
  steps to produce $M$ instances of the electric field vector in the
  other mode then, for each instance of the electric field vectors
  from modes $A$ and $B$, produce $M$ new instances
  $\mbf{e}=\mbf{e}_A+\mbf{e}_B$.
  
\item Compute the instantaneous Stokes parameters,
  $s_\irow=\mbf{e}^\dagger\pauli{\irow}\mbf{e}$.

\item Optionally divide the sequence of $M$ instantaneous Stokes
  vectors into mutually exclusive Stokes samples of $n$ instances,
  yielding a sequence of $N=M/n$ Stokes samples.  This step is not
  optional when simulating composite samples.

\item If simulating \emph{composite samples}, replace $(1-f)n$ instances
  in each Stokes sample with instantaneous Stokes vectors in the
  other mode.

\item If simulating \emph{disjoint samples}, replace $(1-F)N$ Stokes
  samples with Stokes samples that contain only instantaneous
  Stokes vectors in the other mode.

\item For each Stokes sample, compute the sample mean Stokes
  parameters $\bar{S}_\irow$.

\item Compute the $4\times4$ covariances between the Stokes parameters
  using either the $M$ instantaneous Stokes parameters or the $N$
  sample mean Stokes parameters.
    
\end{enumerate}
%

Following the simulation, {\sc epsic} reports
\begin{itemize}
  \item the expected population mean Stokes parameters and $4\times4$
    matrix of covariances between the instantaneous or sample mean
    Stokes parameters;

  \item the values of the above quantities as derived from the
    simulated data;

  \item the mean value of the degree of polarization, derived from the
    simulated instantaneous or sample mean Stokes parameters; and

  \item the modulation index derived from simulated data.
\end{itemize}

{\sc epsic} currently does not verify that the computed covariance
matrix matches the theoretical prediction within the uncertainty due
to noise.

\section{ Simulation Model Parameters }

The simulation can be configured using the following parameters, each of
which corresponds to a command line option.  For a brief list of
options and their arguments, run {\tt epsic -h}.

\begin{itemize}

\item By default, {\sc epsic} simulates the polarized electromagnetic
  radiation of a single source.  To simulate a combination of two
  sources, use one of the following three options:

  \begin{itemize}
  \item Enable {\bf superposed modes} using the {\tt -S} option, which
    has no arguments.

  \item Enable {\bf disjoint modes} using the {\tt -D} option; the argument
    to this option is the fraction of Stokes samples that occur in mode A
    in the simulated population.

  \item Enable {\bf composite samples of disjoint modes} using the
    {\tt -C} option; the argument to this option is the fraction of
    electric field instances that occur in mode A in each Stokes sample.

  \end{itemize}

\item The {\bf Stokes sample size} can be set using the {\tt -n}
  option.  The argument to this option is the integer number of
  instances of the electric field in each Stokes sample.  By default,
  {\sc epsic} calculates the statistics of the instantaneous Stokes
  parameters (i.e. $n=1$).

\item The {\bf population size} can be set using the {\tt -N}
  option.  The argument to this option is the floating point number
  of mega Stokes samples to simulate, where a mega Stokes sample is
  $2^{20}$ Stokes samples.  The total number of instances of electric
  field vectors that will be simulated is the population size times
  the Stokes sample size.
   
\item The {\bf population mean Stokes parameters} can be set using the
  {\tt -s} option. The argument to this option is a comma separated list
  of the four population mean Stokes parameters, $I,Q,U,V$; e.g.  {\tt
    epsic -s 5.3,0,0,-1.4} will simulate polarized noise with a total
  intensity (Stokes $I$) of 5.3 units and circularly polarized
  intensity (Stokes $V$) of -1.4 units.  By default, {\sc epsic} will
  simulate unpolarized noise with population mean
  intensity equal to unity.
  
\item Optional {\bf amplitude modulation} is enabled using the {\tt
  -l} option.  The argument to this option is the standard deviation
  $\varsigma$ of the normally distributed variate that is used to
  generate a lognormal distribution.  For example, {\tt epsic -l
    0.2} will cause {\tt epsic} to multiply each electric field
  instance by $u=\exp(v/2)$, where $v$ is normally distributed with
  mean equal to zero and standard deviation equal to 0.2.  When
  amplitude modulation is enabled using the {\tt -l} option, the
  following options apply.
  
  \begin{itemize}
  \item
    The amplitude modulating function can be set to a contiguous
    sequence of {\bf rectangular pulses} using the {\tt -r} option.  The
    argument to this option is the integer number of instances of the
    electric field to be multiplied by a single value of $u$. 
  \item
    The amplitude modulating function can be {\bf boxcar smoothed} using the
    {\tt -b} option.  The argument to this option is the width of the
    boxcar expressed as the integer number of instances of the
    electric field that it spans.
  \end{itemize}

\end{itemize}
%

\noindent
If simulating a combination of two sources, either the population mean
Stokes parameters or the modulation properties of
  the second source can be specified by preceding the argument to any
  of {\tt -s}, {\tt -l}, {\tt -r} and/or {\tt -b} with the letter `{\tt B}';
  e.g. {\tt epsic -S -l B0.5 -b B4}.

\section{ Cross-covariances between the Stokes parameters }

{\sc epsic} can also report the measured and predicted cross-covariances between the Stokes parameters as a function of lag.  Currently, this works only for the instantaneous Stokes parameters.  To try it out, add {\tt -X} to the command line; the results will be printed to a text file named {\tt acf.txt}.

\end{document}


